<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Th·ª±c hi·ªán y l·ªánh thu·ªëc</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        td.ten-thuoc {
            white-space: normal !important;
            word-wrap: break-word;
        }
    </style>
</head>

<body class="bg-light">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <button class="btn btn-link text-white me-2" onclick="window.location.href='patients.html'">
                <i class="bi bi-arrow-left"></i>
            </button>
            <span class="navbar-brand">Y l·ªánh thu·ªëc</span>
            <div class="d-flex ms-auto text-white">
                <span class="me-3">üë©‚Äç‚öïÔ∏è ƒêi·ªÅu d∆∞·ª°ng: <strong id="nurseInfo"></strong></span>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4>üë§ B·ªánh nh√¢n: <span class="text-primary" id="patientInfo"></span></h4>
            <button class="btn btn-success" id="btnSign">K√Ω ‚úî</button>
        </div>
        <div class="table-responsive">
            <table class="table table-bordered table-hover bg-white shadow-sm align-middle">
                <thead class="table-secondary">
                    <tr>
                        <th scope="col" style="width: 50px;">‚úî</th>
                        <th scope="col">T√™n thu·ªëc / Ghi ch√∫</th>
                        <th scope="col" style="width: 150px;">Gi·ªù</th>
                        <th scope="col" style="width: 150px;">S·ªë l∆∞·ª£ng</th>
                    </tr>
                </thead>
                <tbody id="drugList"></tbody>
            </table>
        </div>
    </div>

    <script>
        const nurse = localStorage.getItem("nurseName") || "Ch∆∞a login";
        const patient = localStorage.getItem("patientName") || "Ch∆∞a ch·ªçn";
        document.getElementById("nurseInfo").innerText = nurse;
        document.getElementById("patientInfo").innerText = patient;

        // gi·∫£ l·∫≠p thu·ªëc
        const drugs = [
            { name: "Paracetamol 500mg", note: "U·ªëng sau ƒÉn" },
            { name: "Amoxicillin 500mg", note: "Tr√°nh d√πng chung v·ªõi s·ªØa" },
            { name: "Vitamin C", note: "Tr√°nh d√πng chung v·ªõi s·ªØa" },
            { name: "ƒê·ªìng", note: "Tr√°nh d√πng chung v·ªõi s·ªØa" }
        ];

        const tbody = document.getElementById("drugList");
        drugs.forEach(d => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
        <td class="text-center"><input type="checkbox"></td>
        <td class="ten-thuoc">
          ${d.name} <br><small class="text-muted">Ghi ch√∫: ${d.note}</small>
        </td>
        <td><input type="time" class="form-control form-control-sm"></td>
        <td>
          <div class="input-group input-group-sm">
            <input type="number" class="form-control" min="1" max="99" style="max-width:70px;">
            <span class="input-group-text">vi√™n</span>
          </div>
        </td>
      `;
            tbody.appendChild(tr);
        });

        document.getElementById("btnSign").addEventListener("click", function () {
            const rows = document.querySelectorAll("#drugList tr");
            let signedData = [];
            rows.forEach(row => {
                if (row.querySelector("input[type=checkbox]").checked) {
                    signedData.push({
                        drug: row.querySelector(".ten-thuoc").innerText.trim(),
                        time: row.querySelector("input[type=time]").value,
                        quantity: row.querySelector("input[type=number]").value
                    });
                }
            });

            if (signedData.length === 0) {
                alert("B·∫°n ch∆∞a ch·ªçn thu·ªëc n√†o ƒë·ªÉ k√Ω!");
                return;
            }

            console.log("D·ªØ li·ªáu g·ª≠i server:", {
                nurse: nurse,
                patient: patient,
                drugs: signedData
            });

            alert("ƒê√£ k√Ω th√†nh c√¥ng (demo, ch∆∞a g·ª≠i server)!");
        });
    </script>
</body>

</html>